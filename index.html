<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IITSM AI Teacher - Chat</title>
    
    <!-- n8n Chat CSS -->
    <link href="https://cdn.jsdelivr.net" rel="stylesheet" />
</head>
<body class="bg-slate-50">

    <div style="text-align: center; margin-top: 50px; font-family: sans-serif;">
        <h1>IITSM AI Teacher Chat System</h1>
        <p>வலது கீழ் பக்கத்தில் உள்ள சாட் குமிழியை (Chat Bubble) கிளிக் செய்யவும்.</p>
        <p style="font-size: 12px; color: #666;">License ID: <span id="ldisplay">Loading...</span></p>
    </div>

    <!-- n8n Chat JavaScript -->
    <script type="module">
        import { createChat } from 'https://cdn.jsdelivr.net';

        // 1. URL-லிருந்து license_id-ஐ எடுக்கிறது
        const params = new URLSearchParams(window.location.search);
        const licenseID = params.get("license_id") || "NO_LICENSE_FOUND";
        
        document.getElementById("ldisplay").innerText = licenseID;

        // 2. n8n Chat-ஐ உருவாக்குகிறது
        createChat({
            webhookUrl: 'https://n8n.srv933517.hstgr.cloud/webhook/dd36755c-72c7-40a1-823a-c54d493664c0/chat',
            
            // n8n-க்கு தானாகவே டேட்டாவை அனுப்ப metadata பயன்படுகிறது
            metadata: {
                license_id: licenseID,
                source_url: window.location.href, // தற்போதைய URL
                platform: "GitHub Pages"
            },
            
            showWelcomeScreen: true,
            title: 'IITSM AI Teacher',
            welcomeMessage: 'வணக்கம்! நான் உங்களுக்கு எப்படி உதவ முடியும்?',
            
            style: {
                primaryColor: '#4f46e5', // Indigo color
            }
        });
    </script>

</body>
</html>
